<!doctype html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/vendor/fonts/circular-std/style.css">
    <link rel="stylesheet" href="assets/libs/css/style.css">
    <link rel="stylesheet" href="assets/vendor/fonts/fontawesome/css/fontawesome-all.css">
    <link rel="stylesheet" href="assets/vendor/vector-map/jqvmap.css">
    <link rel="stylesheet" href="assets/vendor/jvectormap/jquery-jvectormap-2.0.2.css">
    <link rel="stylesheet" href="assets/vendor/charts/c3charts/c3.css">
    <link rel="stylesheet" href="assets/vendor/charts/morris-bundle/morris.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/daterangepicker/daterangepicker.css"/>
    <title>首页</title>
</head>
<style>
    html, body {
        height: 100%;
    }

    .contain {
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .header {
        height: 83px;
    }

    .main {
        flex: 1;
        display: flex;
        flex-direction: row;
    }

    .left {
        width: 264px;
        height: 100%;
        display: block;
    }

    .right {
        flex: 1;
        height: 100%;
        background-color: white;
        padding: 0px 4px;
        margin-top: -2px;
    }

    iframe {
        height: 100%;
    }

    .showTime {
        float: right;
        /*position: absolute;*/
        top: 0;
        /*margin-right: 10px;*/
        margin-top: 25px;
        right: 0.375rem;
        line-height: 0.9375rem;
        font-size: 15px;
        color: cornflowerblue;
    }
</style>
<body>
<div class="contain">
    <div class="header">
        <nav class="navbar navbar-expand-lg bg-white fixed-top">
            <img src="images/xh.png" style="height: 70px;width: 70px;margin-left: 20px">
            <a class="navbar-brand" href="index.html" style="color: #2F80ED">
                学生全过程监控系统</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse " id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto navbar-right-top">

                 <!--   <script>
                        var t = null;
                        t = setTimeout(time, 1000); //開始运行
                        function time() {
                            clearTimeout(t); //清除定时器
                            dt = new Date();
                            var y = dt.getFullYear();
                            var mt = dt.getMonth() + 1;
                            var day = dt.getDate();
                            var h = dt.getHours(); //获取时
                            var m = dt.getMinutes(); //获取分
                            var s = dt.getSeconds(); //获取秒
                            document.querySelector(".showTime").innerHTML =
                                // "当前时间：" +
                                y +
                                "年" +
                                mt +
                                "月" +
                                day +
                                "日-" +
                                h +
                                "时" +
                                m +
                                "分" +
                                s +
                                "秒"
                            ;
                            t = setTimeout(time, 1000); //设定定时器，循环运行
                        }
                    </script>-->

                    <div class="nav-user-info">
                        <h5 class="mb-0 text-white nav-user-name" th:if="${session.user}"
                            th:text="'欢迎您,' + ${session.user.username} + '老师'"></h5>
                        <!--                                <span class="status"></span><span class="ml-2">Available</span>-->
                    </div>
                    <div class="showTime">2020年10月28日</div>
                    <li class="nav-item dropdown nav-user">
                        <a class="nav-link nav-user-img" href="#" id="navbarDropdownMenuLink2" data-toggle="dropdown"
                           aria-haspopup="true" aria-expanded="false">

                            <img src="images/user.png" alt="" class="user-avatar-md rounded-circle">
                        </a>
                        <div class="dropdown-menu dropdown-menu-right nav-user-dropdown"
                             aria-labelledby="navbarDropdownMenuLink2">

                            <a class="dropdown-item" data-toggle="modal" data-target="#updatePassword"><i
                                    class="fas fa-user mr-2"></i>修改密码</a>
                            <!--                            <a class="dropdown-item" href="#"><i class="fas fa-cog mr-2"></i>退出登录</a>-->
                            <a class="dropdown-item" th:href="@{/login/logout}"><i
                                    class="fas fa-power-off mr-2"></i>退出登录</a>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
    </div>

    <div class="modal fade" id="updatePassword">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- 模态框头部 -->
                <div class="modal-header">
                    <h4 class="modal-title">修改密码</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <form class="form-horizontal" id="password" action="javascript:update()">
                    <!-- 模态框主体 -->
                    <div class="modal-body">

                        <div class="form-group">
                            <label class="col-sm-3 control-label">原密码</label>
                            <div class="col-sm-8">
                                <input name="password" class="form-control" type="password" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-3 control-label">新密码</label>
                            <div class="col-sm-8">
                                <input name="newPassword" class="form-control" type="password" required>
                            </div>
                        </div>

                    </div>

                    <!-- 模态框底部 -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default"
                                data-dismiss="modal">关闭
                        </button>
                        <button type="submit" class="btn btn-primary">
                            确定
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="main">
        <div class="left">
            <div class="nav-left-sidebar sidebar-dark">
                <div class="menu-list menu">
                    <nav class="navbar navbar-expand-lg navbar-light">
                        <!--                <a class="d-xl-none d-lg-none" href="#">首页</a>-->
                        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarNav">
                            <ul class="navbar-nav flex-column">
                                <!--<li class="nav-divider active">
                                    <a role="button" style="text-decoration: none;color: white;font-size: 17px"
                                       data-toggle="collapse"
                                       data-parent="#accordion" href="#" onclick="goto('/index/home')"
                                       aria-expanded="true"
                                       aria-controls="collapseS">
                                        首页
                                    </a>
                                </li>-->

                                <li class="nav-item">
                                    <a class="nav-link" href="#index"
                                       onclick="goto('/index/home')">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-house"
                                             fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd"
                                                  d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
                                            <path fill-rule="evenodd"
                                                  d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
                                        </svg>&nbsp;&nbsp;
                                        首页</a>

                                </li>

                                <li class="nav-item">
                                    <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false"
                                       data-target="#submenu-4" aria-controls="submenu-4"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-lock" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M11.5 8h-7a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1zm-7-1a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h7a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-7zm0-3a3.5 3.5 0 1 1 7 0v3h-1V4a2.5 2.5 0 0 0-5 0v3h-1V4z"/>
                                    </svg>&nbsp;&nbsp;权限管理</a>
                                    <div id="submenu-4" class="collapse submenu" style="">
                                        <ul class="nav flex-column">
                                            <li class="nav-item">
                                                <a onclick="goto('/user/student')"
                                                   href="#score" class="nav-link">学生账号</a>
                                            </li>
                                            <li class="nav-item"
                                                th:if="${session.user!=null&&session.user.role <= 20}">
                                                <a onclick="goto('/user/assistant')"
                                                   href="#assessment" class="nav-link">院辅导员账号</a>
                                            </li>
                                            <li class="nav-item" th:if="${session.user!=null&&session.user.role <= 10}">
                                                <a onclick="goto('/user/depLead')"
                                                   href="#assessment" class="nav-link">院领导</a>
                                            </li>
                                            <li class="nav-item" th:if="${session.user!=null&&session.user.role < 10}">
                                                <a onclick="goto('/user/scLead')"
                                                   href="#assessment" class="nav-link">校领导</a>
                                            </li>

                                        </ul>
                                    </div>
                                </li>


                                <li class="nav-item">
                                    <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false"
                                       data-target="#submenu-5" aria-controls="submenu-5"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-clock-history" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"/>
                                        <path fill-rule="evenodd" d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"/>
                                        <path fill-rule="evenodd" d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"/>
                                    </svg>&nbsp;&nbsp;历史</a>
                                    <div id="submenu-5" class="collapse submenu" style="">
                                        <ul class="nav flex-column">
                                            <li class="nav-item">
                                                <a onclick="goto('/history/')"
                                                   href="#history" class="nav-link">历史纪录</a>
                                            </li>

                                        </ul>
                                    </div>
                                </li>


                                <li class="nav-item ">
                                    <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false"
                                       data-target="#submenu-1" aria-controls="submenu-1">
                                        <i class="fa fa-fw fa-user-circle"></i>
                                        学生信息
                                        <span class="badge badge-success">6</span>
                                    </a>
                                    <div id="submenu-1" class="collapse submenu" style="">
                                        <ul class="nav flex-column">
                                            <li class="nav-item">
                                                <a class="nav-link" onclick="goto('/student')"
                                                   href="#student">基本信息</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" onclick="goto('/preWarning')"
                                                   href="#preWarning">学业预警</a>
                                            </li>

                                            <li class="nav-item">
                                                <a class="nav-link" onclick="goto('/score/slip')"
                                                   href="#score/slip">下滑预警</a>
                                            </li>

                                            <li class="nav-item">
                                                <a class="nav-link" onclick="goto('/retardation')"
                                                   href="#retardation">留级试读</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" onclick="goto('/suspension')"
                                                   href="#suspension">休复退学</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" onclick="goto('/transfer')"
                                                   href="#transfer">转专业</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" onclick="goto('/monitoring')"
                                                   href="#monitoring">学业监控</a>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false"
                                       data-target="#submenu-2" aria-controls="submenu-2"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-clipboard-check" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                        <path fill-rule="evenodd" d="M9.5 1h-3a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3zm4.354 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                                    </svg>&nbsp;&nbsp;成绩管理</a>
                                    <div id="submenu-2" class="collapse submenu" style="">
                                        <ul class="nav flex-column">
                                            <li class="nav-item">
                                                <a onclick="goto('/score')"
                                                   href="#score" class="nav-link">智育成绩</a>
                                            </li>
                                            <li class="nav-item">
                                                <a onclick="goto('/score/total')"
                                                   href="#assessment" class="nav-link">综合测评</a>
                                            </li>
                                        </ul>
                                    </div>
                                </li>

                                <li class="nav-item">
                                    <a class="nav-link" href="#reward"
                                       onclick="goto('/reward')">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-award" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M9.669.864L8 0 6.331.864l-1.858.282-.842 1.68-1.337 1.32L2.6 6l-.306 1.854 1.337 1.32.842 1.68 1.858.282L8 12l1.669-.864 1.858-.282.842-1.68 1.337-1.32L13.4 6l.306-1.854-1.337-1.32-.842-1.68L9.669.864zm1.196 1.193l-1.51-.229L8 1.126l-1.355.702-1.51.229-.684 1.365-1.086 1.072L3.614 6l-.25 1.506 1.087 1.072.684 1.365 1.51.229L8 10.874l1.356-.702 1.509-.229.684-1.365 1.086-1.072L12.387 6l.248-1.506-1.086-1.072-.684-1.365z"/>
                                            <path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
                                        </svg>&nbsp;&nbsp;
                                        奖惩</a>
                                </li>



                                <li class="nav-item">
                                    <a class="nav-link" href="#employment"
                                       onclick="goto('/employment')">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-briefcase" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M0 12.5A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-6h-1v6a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-6H0v6z"/>
                                            <path fill-rule="evenodd" d="M0 4.5A1.5 1.5 0 0 1 1.5 3h13A1.5 1.5 0 0 1 16 4.5v2.384l-7.614 2.03a1.5 1.5 0 0 1-.772 0L0 6.884V4.5zM1.5 4a.5.5 0 0 0-.5.5v1.616l6.871 1.832a.5.5 0 0 0 .258 0L15 6.116V4.5a.5.5 0 0 0-.5-.5h-13zM5 2.5A1.5 1.5 0 0 1 6.5 1h3A1.5 1.5 0 0 1 11 2.5V3h-1v-.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V3H5v-.5z"/>
                                        </svg>&nbsp;&nbsp;
                                        就业</a>
                                </li>


                              <!--  <li class="nav-item">
                                    <a class="nav-link" href="#" data-toggle="collapse" aria-expanded="false"
                                       data-target="#submenu-7" aria-controls="submenu-5"><i
                                            class="fas fa-fw fa-inbox"></i>办事机构</a>
                                </li>-->

                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>

        <div class="right">
            <iframe id="frame" src="/index/home" frameborder="0" scrolling="auto"
                    style="min-height:600px;width:100%;height:100%;"
                    seamless></iframe>
        </div>

    </div>

</div>
<script src="/js/jquery.js"></script>
<script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
<!-- bootstap bundle js -->
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.js"></script>
<!-- slimscroll js -->
<script src="assets/vendor/slimscroll/jquery.slimscroll.js"></script>
<!-- chart chartist js -->
<script src="assets/vendor/charts/chartist-bundle/chartist.min.js"></script>
<script src="assets/vendor/charts/chartist-bundle/Chartistjs.js"></script>
<script src="assets/vendor/charts/chartist-bundle/chartist-plugin-threshold.js"></script>
<!-- chart C3 js -->
<script src="assets/vendor/charts/c3charts/c3.min.js"></script>
<script src="assets/vendor/charts/c3charts/d3-5.4.0.min.js"></script>
<!-- chartjs js -->
<script src="assets/vendor/charts/charts-bundle/Chart.bundle.js"></script>
<script src="assets/vendor/charts/charts-bundle/chartjs.js"></script>
<!-- sparkline js -->
<script src="assets/vendor/charts/sparkline/jquery.sparkline.js"></script>
<!-- dashboard finance js -->
<!-- main js -->
<script src="assets/libs/js/main-js.js"></script>
<!-- gauge js -->
<script src="assets/vendor/gauge/gauge.min.js"></script>
<!-- morris js -->
<script src="assets/vendor/charts/morris-bundle/raphael.min.js"></script>
<script>
    $(function () {
        $("#password").validate({
            rules: {},
            messages: {},
            submitHandler: function (form) {
                update()
            }
        });
    });

    function goto(url) {
        $("#frame").attr("src", url);
    }


    function update() {
        if (!$("#password").valid()) {
            return;
        }
        $.ajax({
            //cache: true,
            type: "POST",
            url: "/login/password",
            data: $('#password').serialize(),
            success: function (res) {
                if (res.code == 1) {
                    //操作成功，关闭模态框
                    $('#updatePassword').modal('hide')
                    window.location.href = "/"
                } else {
                    alert(res.msg)
                }
            }
        });
    }
</script>

</body>
</html>
